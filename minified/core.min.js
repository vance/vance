!function(){"use strict";angular.module("FScapeApp.Services").factory("AuthTest",["$resource",function(){var a={};return a}])}(),function(){"use strict";angular.module("FScapeApp.Controllers").service("BaseController",["$routeParams","$location",function(a,b){return function(c){return{scope:null,urlParams:null,rootRoute:null,instanceNumber:null,init:function(){this.scope=c,this.defineListeners(),this.instanceNumber=Math.round(1e4*Math.random())+1,this.urlParams=this.getMap(a.wildcard),this.route=b.path().split("/")[1],this.onInit&&this.onInit()},defineListeners:function(){var a=this;this.scope.$on("$destroy",function(){a.destroy()}),this.onDefineListeners&&this.onDefineListeners()},removeListeners:function(){this.onRemoveListeners&&this.onRemoveListeners()},destroy:function(){this.removeListeners(),this.onDestroy&&this.onDestroy()},getMap:function(a){var b={};if(void 0===a)return b;var c=["padding"];c=c.concat(a.split("/"));for(var d=0;d<c.length;d++)d%2===0&&0!==d&&(b[c[d-1]]=c[d]);return b},buildPath:function(a){var b,c=[];for(var d in a)a.hasOwnProperty(d)&&(c.push(d),c.push(a[d]));return b=c.join("/")}}}}])}(),function(){"use strict";angular.module("FScapeApp.Services").factory("BaseHttpService",["$http","settings",function(a,b){return function(){return{buildResourcePath:function(a){var c=a,d="";void 0===a&&(c=this.servicePath);var e=b.serviceConfig.endpoints[c];if(void 0===e||null===e)throw new Error("\n\n > WARNING! Please add a node in the settings file for your endpoint("+c+"). < \n \n");return d=""!==e.version?this.addSlash(e.absoluteUrl)+e.version:e.absoluteUrl,this.addSlash(d)},getAll:function(){var b=this.buildResourcePath();return a({url:b,method:"GET",data:{},params:{}})},getBy:function(b,c){var d=this.buildResourcePath()+b+"/"+c;return a({url:d,method:"GET",data:{},params:{}})},add:function(b){var c=this.buildResourcePath();return a({url:c,method:"POST",data:b,params:{}})},update:function(b){var c="";void 0!==b.id&&null!==b.id&&(c=b.id);var d=this.buildResourcePath();return a({url:d,method:"PUT",data:b,params:{}})},raiseTestHttpError:function(){return a({url:"http://localhost:8282/jiggy",method:"DELETE",data:{nothing:"to see here"},params:{}})},addSlash:function(a){return"/"!==a.charAt(a.length-1)&&(a+="/"),a}}}}])}(),angular.module("FScapeApp.Models").factory("BaseModel",function(){var a=function(a,b){this.data=a,this.service=b};return a.prototype.setDataById=function(a,b){for(var c=this,d=0;d<c.data.length;d++)if(c.data[d].id===a)for(var e in b)c.data[d][e]=b[e]},a.prototype.getById=function(a){var b=this;return this.service.getBy("id",a).then(function(a){b.data=a.data})},a.prototype.getAll=function(){var a=this;return this.service.getAll().then(function(b){a.data=b.data})},a.prototype.getBy=function(a,b){var c=this;return this.service.getBy(a,b).then(function(a){c.data=a.data})},a.prototype.add=function(a){var b=this;return this.service.add(a).then(function(c){a.id=c.data.id,b.data.push(a)})},a}),function(){"use strict";angular.module("FScapeApp.Controllers").controller("GlobalController",["$scope","settings","BaseController","$rootScope","ErrorModal","SuccessModal","globalModelService",function(a,b,c,d,e,f,g){var h={onInit:function(){this.$scope=a,app.$globalScope=this.$scope,app.settings=b,g.setSuccessCallback(this.showSuccess),d.$on("serverError",this.showError.bind(this))},showSuccess:function(){f.activate()},showError:function(){e.activate()}};return angular.extend(h,new c(a)),h.init(),h}])}(),function(){"use strict";var a=[],b=function(b){a.push("<br/>"+b),$("#trace").html(a.join("")),a.length>10&&a.shift()};angular.module("FScapeApp.Controllers").controller("foreverScapeEngineController",["$scope","BaseController","$location","configModel","tileModel","gridModel","$rootScope","fscapeService",function(a,c,d,e,f,g,h,i){var j={_hasGrid:!1,_allowTouch:!0,zoom:.36,zoomMax:1.6,zoomMin:.5,offsetX:0,offsetY:-350,time:0,canIntro:!0,mouseDownX:null,mouseDownY:null,mouseX:null,mouseY:null,mousePreviousX:0,mousePreviousY:0,dx:0,dy:0,startDragTime:new Date,endDragTime:new Date,_mouseDown:!1,_dragging:!1,_flickingX:!1,_flickingY:!1,_scaling:!1,flickTweenX:null,flickTweenY:null,zoomTween:null,prevPinchDist:0,offscreenLeft:-1004,offscreenRight:2e5,offscreenTop:-1e4,offscreenBottom:2e4,hide:!1,location:d,imageTiles:[],gridBoxes:[],config:null,endCoords:{},startCoords:{},is_touch_device:!1,onInit:function(){var b=this;a.trace="",this.buildGrid(),this.setupTouchEvents(),h.$on("fscape.togglePlayback",function(){}),setTimeout(function(){b.canIntro&&(b.offsetX-=900,TweenMax.to($(".engine-position"),3,{css:{left:b.offsetX,top:b.offsetY}}))},2500),$(".preload-junk").html("")},setupTouchEvents:function(){var a=this;a.is_touch_device="ontouchstart"in document.documentElement||"ontouchstart"in window,$(document).bind("gesturestart",function(a){a.originalEvent.preventDefault()},!1),$(document).bind("gestureend",function(a){a.originalEvent.preventDefault()},!1),$(document).bind("touchstart",function(b){return b.preventDefault(),b.originalEvent.preventDefault(),2===b.originalEvent.touches.length||2===b.originalEvent.targetTouches.length?(a._scaling=!0,void a.pinchStart(b)):void(a._allowTouch&&(a._allowTouch=!1,a.mouseDownX=b.originalEvent.targetTouches[0].pageX||b.originalEvent.changedTouches[0].pageX||b.originalEvent.touches[0].pageX,a.mouseDownY=b.originalEvent.targetTouches[0].pageY||b.originalEvent.changedTouches[0].pageY||b.originalEvent.touches[0].pageY,a.mouseX=b.originalEvent.targetTouches[0].pageX||b.originalEvent.changedTouches[0].pageX||b.originalEvent.touches[0].pageX,a.mouseY=b.originalEvent.targetTouches[0].pageY||b.originalEvent.changedTouches[0].pageY||b.originalEvent.touches[0].pageY,a.down()))}),$(document).bind("touchmove",function(b){return b.preventDefault(),b.originalEvent.preventDefault(),a._scaling?void a.pinchMove(b):(a.mouseX=b.originalEvent.targetTouches[0].pageX||b.originalEvent.changedTouches[0].pageX||b.originalEvent.touches[0].pageX,a.mouseY=b.originalEvent.targetTouches[0].pageY||b.originalEvent.changedTouches[0].pageY||b.originalEvent.touches[0].pageY,void a.move())}),$(document).bind("touchend",function(b){return b.preventDefault(),b.originalEvent.preventDefault(),window.clearTimeout(a.touchTimeout),a.touchTimeout=window.setTimeout(function(){a._allowTouch=!0},300),a._scaling?(a.pinchEnd(b),void(a._scaling=!1)):void a.up()}),$(document).bind("touchcancel",function(a){a.preventDefault(),a.originalEvent.preventDefault()}),e.getConfig().then(function(){b("gotConfig"),a.config=e.data,a.gridBoxes=g.gridBoxes,f.getTiles().then(function(c){a.imageTiles=c,b("got tiles"),a.setZoomTarget()})}),$(document).mousewheel(function(b){b.originalEvent.preventDefault(),b.deltaY>0?a.zoomIn():a.zoomOut()})},pinchStart:function(a){this.startDistance=this.getPinchDistance(a)},pinchMove:function(a){var b=this.getPinchDistance(a);b-this.prevPinchDist>0?(this.zoomIn(),this.setZoomTarget()):this.zoomOut(),this.prevPinchDist=b},pinchEnd:function(){b("pinchEnd")},getPinchDistance:function(a){var b=0;return a.originalEvent.touches[0]?b=Math.sqrt((a.originalEvent.touches[0].pageX-a.originalEvent.touches[1].pageX)*(a.originalEvent.touches[0].pageX-a.originalEvent.touches[1].pageX)+(a.originalEvent.touches[0].pageY-a.originalEvent.touches[1].pageY)*(a.originalEvent.touches[0].pageY-a.originalEvent.touches[1].pageY)):a.originalEvent.changedTouches[0]&&(b=Math.sqrt((a.originalEvent.changedTouches[0].pageX-a.originalEvent.changedTouches[1].pageX)*(a.originalEvent.changedTouches[0].pageX-a.originalEvent.changedTouches[1].pageX)+(a.originalEvent.changedTouches[0].pageY-a.originalEvent.changedTouches[1].pageY)*(a.originalEvent.changedTouches[0].pageY-a.originalEvent.changedTouches[1].pageY))),b},mouseDown:function(a){a.preventDefault(),this.is_touch_device||(b("mouseDown"),this.mouseDownX=a.pageX,this.mouseDownY=a.pageY,this.mouseX=a.pageX,this.mouseY=a.pageY,this.down())},down:function(){this.canIntro=!1,this.startDragTime=new Date,this.mousePreviousX=this.mouseX,this.mousePreviousY=this.mouseY,this._mouseDown=!0,this._flickingX=!1,this._flickingY=!1,this.dx=0,this.dy=0,this.flickTweenX&&(this.offsetX=parseInt($(".engine-position").css("left"),10),this.flickTweenX.kill()),this.flickTweenY&&(this.offsetY=parseInt($(".engine-position").css("top"),10),this.flickTweenY.kill())},mouseMove:function(a){a.preventDefault(),this.is_touch_device||(this.mouseX=a.pageX,this.mouseY=a.pageY,this.move())},move:function(){this.endDragTime=new Date,this.dx=this.mouseX-this.mousePreviousX,this.dy=this.mouseY-this.mousePreviousY,this._mouseDown&&!this._flickingX&&(this._dragging=!0,this.offsetX+=3*this.dx*(this.zoomMax+.1-this.zoom),this.setCSSPosition()),this._mouseDown&&!this._flickingY&&(this._dragging=!0,this.offsetY+=3*this.dy*(this.zoomMax+.1-this.zoom),this.setCSSPosition()),this.mousePreviousX=this.mouseX,this.mousePreviousY=this.mouseY},setCSSPosition:function(){$(".engine-position").css({left:this.offsetX,top:this.offsetY})},mouseUp:function(a){a.preventDefault(),this.is_touch_device||(b("mouseUp"),this.up())},up:function(){this.endDragTime=new Date,this._mouseDown=!1,this._dragging=!1,this.flick()},flick:function(){var c=this,d=this.endDragTime-this.startDragTime;if(0!==d){var e=this.dx/d,f=this.dy/d;(!this._flickingX&&Math.abs(e)>.15||Math.abs(f)>.15)&&(b("flickX start"),this._flickingX=!0,this.offsetX+=3e3*e,this.flickTweenX=TweenMax.to($(".engine-position"),1,{css:{left:c.offsetX},onComplete:function(){c._flickingX=!1,a.$apply()}})),(!this._flickingY&&Math.abs(e)>.15||Math.abs(f)>.15)&&(b("flickY start"),this._flickingY=!0,this.offsetY+=3e3*f,this.flickTweenY=TweenMax.to($(".engine-position"),1,{css:{top:c.offsetY},onComplete:function(){c._flickingY=!1,a.$apply()}}))}},zoomIn:function(a){a||(a=1),this.zoom>this.zoomMax||(this.zoom+=.025*a,this.setZoomTarget())},zoomOut:function(a){a||(a=1),this.zoom<=.26||(this.zoom-=.025*a,this.setZoomTarget())},setZoomTarget:function(a){var b=this;a&&(b.zoom=a),this.zoomTween&&this.zoomTween.kill(),b.zoomTween=TweenMax.to($(".engine-scale"),0,{css:{scale:b.zoom}})},buildGrid:function(){if(this.gridBoxes.length){for(var a=0;a<this.gridBoxes.length;a++){var b=this.gridBoxes[a],c=document.createElement("div"),d="grid-"+a;c.setAttribute("id",d),c.setAttribute("class","grid-box"),c.setAttribute("style","left:"+b.x+"px;top:"+b.y+"px;");var e=document.createElement("img");e.setAttribute("class","full"),e.setAttribute("id","full-"+d);var f=document.createElement("img");f.setAttribute("class","thumb"),f.setAttribute("id","thumb-"+d),f.setAttribute("src",b.currentTile.thumbUrl),jQuery(c).append(f),jQuery(c).append(e),jQuery("#tile-engine").append(c)}this._hasGrid=!0}},render:function(){var a=this;if(a.time+=1,null!==a.config){if(!this._hasGrid)return void this.buildGrid();i.isPlaying&&(this.offsetX+=10,console.log(" scolling",this.offsetX));var b=4*this.config.tileWidth*this.zoom;this.offscreenLeft=100-b,this.offscreenRight=16*this.config.tileWidth*this.zoom-b;var c=4*this.config.tileHeight*this.zoom;this.offscreenTop=50-c,this.offscreenBottom=11*this.zoom*this.config.tileHeight-c;for(var d=0;d<this.gridBoxes.length;d++){var e=a.gridBoxes[d];e.element||(e.element=$("#"+e.domId),e.thumbElement=$("#thumb-"+e.domId),e.fullElement=$("#full-"+e.domId));var f=e.element.offset();e.screenX=parseInt(f.left,10),e.screenY=parseInt(f.top,10),this.setIsOffscreen(e),this.loadFullResTiles(e)}}},setIsOffscreen:function(a){var b=a.screenX<this.offscreenLeft&&this.dx<0,c=a.screenX>=this.offscreenRight&&this.dx>0;b?(a.col+=15,a.currentTileId+=30,a.row+=3):c&&(a.col-=15,a.currentTileId-=30,a.row-=3);var d=a.screenY<this.offscreenTop,e=a.screenY>this.offscreenBottom;d&&this.dy<0?(a.currentTileId+=50,a.row+=10):e&&this.dy>0&&(a.currentTileId-=50,a.row-=10),(b||c||d||e)&&(a.x=a.col*a.width,a.y=a.row*a.height,a.currentTileId<0?a.currentTileId=this.config.totalPages+a.currentTileId:a.currentTileId>=this.config.totalPages&&(a.currentTileId=a.currentTileId-this.config.totalPages),a.currentTile=f.tiles[a.currentTileId],a.element.css({left:a.x}),a.element.css({top:a.y}),a.currentTile&&(a.thumbElement.attr("src")!=a.currentTile.thumbUrl,a.thumbElement.attr("src",a.currentTile.thumbUrl)))},loadFullResTiles:function(a){if(this.zoom>.36&&!this._dragging&&!this._flickingX&&!this._flickingY){var b=a.screenX>-(this.config.tileWidth*this.zoom),c=a.screenX<window.innerWidth,d=a.screenY>-(this.config.tileHeight*this.zoom),e=a.screenY<window.innerHeight+this.config.tileHeight*this.zoom;b&&c&&d&&e&&!a.isOnScreen&&(a.currentTile&&a.fullElement.attr("src").toString()!=a.currentTile.fullUrl.toString(),a.isOnScreen=!0,a.fullElement.attr("src",a.currentTile.fullUrl))}else a.currentTile&&(a.isOnScreen=!1,a.fullElement.attr("src","main/resources/img/blank.gif"))}};return function k(){window.requestAnimFrame(k),j.render()}(),angular.extend(j,new c(a)),j.init(),j}]),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/30)}}(),function(){for(var a=0,b=["webkit","moz"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}()}(),function(){"use strict";angular.module("FScapeApp.Directives").directive("foreverscapeEngine",function(){return{restrict:"E",replace:!0,controller:"foreverScapeEngineController",controllerAs:"fscapeEngineCtrl",templateUrl:"main/core/components/foreverscapeEngine/foreverscape-engine.tpl.html"}})}(),function(){"use strict";angular.module("FScapeApp.Directives").directive("loadIndicator",function(){return{restrict:"E",replace:!0,templateUrl:"main/core/components/loadIndicator/indicator.html",link:function(a,b){return a.$on("loaderShow",function(){return b.show()}),a.$on("loaderHide",function(){return b.hide()})}}})}(),function(){"use strict";angular.module("FScapeApp.Directives").directive("locationTool",function(){return{restrict:"E",replace:!0,templateUrl:"main/core/components/locationTool/location-tool.html"}})}(),function(){"use strict";angular.module("FScapeApp.Controllers").controller("locationTool",["$scope","BaseController","$location","$window","$rootScope","fscapeService",function(a,b,c,d,e,f){var g={hide:!1,location:c,onInit:function(){e.fscape={},a.fscapeService=f,a.win=d,a.isPlaying=!1,angular.element(d).bind("resize",this.onResize),angular.element(d).bind("orientationchange",this.onResize),this.onResize()},togglePlayback:function(){f.togglePlayback()},onResize:function(){(a.windowWidth<450||a.windowHeight<478)&&a.windowHeight<478}};return angular.extend(g,new b(a)),g.init(),g}])}(),function(){"use strict";angular.module("FScapeApp.Controllers").controller("navController",["$scope","BaseController","$location","$window",function(a,b,c,d){var e={hide:!1,location:c,onInit:function(){a.win=d,angular.element(d).bind("resize",this.onResize),angular.element(d).bind("orientationchange",this.onResize),this.onResize()},onResize:function(){a.windowWidth=d.innerWidth,a.windowHeight=d.innerHeight,a.windowWidth<450||a.windowHeight<478?(jQuery(".navigation").hide(),jQuery(".title").css("scale",.7),a.windowHeight<478?(TweenMax.to($(".header-container"),1,{css:{height:"40px"}}),TweenMax.to($(".title"),1,{css:{scale:.5,right:"-60px"}}),TweenMax.to($(".menu"),1,{css:{top:"-4px",scale:.7,left:"1px"}})):(TweenMax.to($(".header-container"),1,{css:{height:"50px"}}),TweenMax.to($(".title"),1,{css:{scale:.7,right:"-40px"}}),TweenMax.to($(".menu"),1,{css:{top:"0px",scale:1,left:"1px"}}))):(jQuery(".navigation").show(),TweenMax.to($(".menu"),1,{css:{top:"9px",scale:1,left:"10px"}}),TweenMax.to($(".header-container"),1,{css:{height:"65px"}}),TweenMax.to($(".title"),1,{css:{scale:1,right:"0px"}}))},navClass:function(){},hideNav:function(){this.hide=!0},goToSearch:function(){return this.location.path("/product-search")},goToError:function(){return this.location.path("/error")}};return angular.extend(e,new b(a)),e.init(),e}])}(),function(){"use strict";angular.module("FScapeApp.Directives").directive("navigation",function(){return{restrict:"E",replace:!0,templateUrl:"main/core/components/nav/navigation.html"}})}(),app.directive("alertSuccess",["$http","$parse",function(){return{require:"ngModel",link:function(){}}}]),app.directive("ensureExpression",["$http","$parse",function(a,b){return{require:"ngModel",link:function(a,c,d,e){a.$watch(d.ngModel,function(){var c=b(d.ensureExpression)(a);e.$setValidity("expression",c)})}}}]),app.directive("someOtherFormValidation",["$http","$parse",function(){return{require:"ngModel",link:function(a,b,c){a.$watch(c.ngModel,function(){})}}}]),app.directive("imageOnload",function(a){return{restrict:"A",link:function(b,c,d){c.bind("load",function(){var b=d.numericId;b&&(a.tiles[parseInt(b,0)].isLoading=!1)})}}}),app.filter("capitalize",function(){return function(a){return null!=a&&(a=a.toLowerCase()),a.substring(0,1).toUpperCase()+a.substring(1)}}),function(){"use strict";angular.module("FScapeApp.Services").factory("httpInterceptor",["$q","$rootScope","$log","$timeout","settings","$location","ErrorService","RedirectionService",function(a,b,c,d,e,f,g){var h=0;return{request:function(c){return c&&c.preventLoader!==!0&&(h++,b.$broadcast("loaderShow")),c||a.when(c)},response:function(c){return--h<=0&&(h=0,b.$broadcast("loaderHide")),c||a.when(c)},responseError:function(c){return--h||b.$broadcast("loaderHide"),c.status>=400?(g.setErrorMessage(c),b.$broadcast("serverError")):c.status>=400&&404===c.status&&(g.errorMessage="Could not load a dependency: 404",b.$broadcast("serverError")),a.reject(c)}}}]),angular.module("FScapeApp.Services").config(["$httpProvider",function(a){a.interceptors.push("httpInterceptor")}])}(),function(){"use strict";angular.module("FScapeApp.Services").factory("RedirectionService",["$location","$cookies",function(a,b){return{hasRedirect:function(){return b.loginRedirectUrl?!0:!1},setRedirectUrl:function(a){null!==a&&a.indexOf("login")<=0&&a.indexOf("timeout")<=0&&(b.loginRedirectUrl=a)},redirect:function(){var c=null;b.loginRedirectUrl&&(c=this.getRedirectUrl(),this.setRedirectUrl(null)),null!==c&&a.path(c)},getRedirectUrl:function(){return b.loginRedirectUrl}}}])}(),function(){"use strict";angular.module("FScapeApp.Services").factory("fscapeService",["$location","$cookies","$rootScope",function(a,b,c){return{isPlaying:!1,offsetX:0,offsetY:0,init:function(){this.isPlaying=!1,this.offset={}},togglePlayback:function(){this.isPlaying=!this.isPlaying,c.$broadcast("fscape.togglePlayback")}}}])}(),function(){"use strict";angular.module("FScapeApp.Services").service("touchService",["$rootScope",function(a){var b={mouseDownX:null,mouseDownY:null,mouseX:null,mouseY:null,mousePreviousX:0,mousePreviousY:0,dx:0,dy:0,startDragTime:new Date,endDragTime:new Date,_mouseDown:!1,_dragging:!1,_flickingX:!1,_flickingY:!1,_scaling:!1,flickTweenX:null,flickTweenY:null,zoomTween:null,prevPinchDist:0,setupTouchEvents:function(){var a=this;a.is_touch_device="ontouchstart"in document.documentElement||"ontouchstart"in window,$(document).bind("gesturestart",function(a){a.originalEvent.preventDefault()},!1),$(document).bind("gestureend",function(a){a.originalEvent.preventDefault()},!1),$(document).bind("touchstart",function(b){return b.preventDefault(),b.originalEvent.preventDefault(),2===b.originalEvent.touches.length||2===b.originalEvent.targetTouches.length?(a._scaling=!0,void a.pinchStart(b)):void(a._allowTouch&&(a._allowTouch=!1,a.mouseDownX=b.originalEvent.targetTouches[0].pageX||b.originalEvent.changedTouches[0].pageX||b.originalEvent.touches[0].pageX,a.mouseDownY=b.originalEvent.targetTouches[0].pageY||b.originalEvent.changedTouches[0].pageY||b.originalEvent.touches[0].pageY,a.mouseX=b.originalEvent.targetTouches[0].pageX||b.originalEvent.changedTouches[0].pageX||b.originalEvent.touches[0].pageX,a.mouseY=b.originalEvent.targetTouches[0].pageY||b.originalEvent.changedTouches[0].pageY||b.originalEvent.touches[0].pageY,a.down()))}),$(document).bind("touchmove",function(b){return b.preventDefault(),b.originalEvent.preventDefault(),a._scaling?void a.pinchMove(b):(a.mouseX=b.originalEvent.targetTouches[0].pageX||b.originalEvent.changedTouches[0].pageX||b.originalEvent.touches[0].pageX,a.mouseY=b.originalEvent.targetTouches[0].pageY||b.originalEvent.changedTouches[0].pageY||b.originalEvent.touches[0].pageY,void a.move())}),$(document).bind("touchend",function(b){return b.preventDefault(),b.originalEvent.preventDefault(),window.clearTimeout(a.touchTimeout),a.touchTimeout=window.setTimeout(function(){a._allowTouch=!0},300),a._scaling?(a.pinchEnd(b),void(a._scaling=!1)):void a.up()}),$(document).bind("touchcancel",function(a){a.preventDefault(),a.originalEvent.preventDefault()}),$(document).mousewheel(function(b){b.originalEvent.preventDefault(),b.deltaY>0?a.zoomIn():a.zoomOut()})},pinchStart:function(a){this.startDistance=this.getPinchDistance(a)},pinchMove:function(a){var b=this.getPinchDistance(a);b-this.prevPinchDist>0?(this.zoomIn(),this.setZoomTarget()):this.zoomOut(),this.prevPinchDist=b},pinchEnd:function(){trace("pinchEnd")},getPinchDistance:function(a){var b=0;return a.originalEvent.touches[0]?b=Math.sqrt((a.originalEvent.touches[0].pageX-a.originalEvent.touches[1].pageX)*(a.originalEvent.touches[0].pageX-a.originalEvent.touches[1].pageX)+(a.originalEvent.touches[0].pageY-a.originalEvent.touches[1].pageY)*(a.originalEvent.touches[0].pageY-a.originalEvent.touches[1].pageY)):a.originalEvent.changedTouches[0]&&(b=Math.sqrt((a.originalEvent.changedTouches[0].pageX-a.originalEvent.changedTouches[1].pageX)*(a.originalEvent.changedTouches[0].pageX-a.originalEvent.changedTouches[1].pageX)+(a.originalEvent.changedTouches[0].pageY-a.originalEvent.changedTouches[1].pageY)*(a.originalEvent.changedTouches[0].pageY-a.originalEvent.changedTouches[1].pageY))),b},mouseDown:function(b){b.preventDefault(),this.is_touch_device||(trace("mouseDown"),this.mouseDownX=b.pageX,this.mouseDownY=b.pageY,this.mouseX=b.pageX,this.mouseY=b.pageY,a.$broadcast("mouseDown"),this.down())},down:function(){this.canIntro=!1,this.startDragTime=new Date,this.mousePreviousX=this.mouseX,this.mousePreviousY=this.mouseY,this._mouseDown=!0,this._flickingX=!1,this._flickingY=!1,this.dx=0,this.dy=0,this.flickTweenX&&(this.offsetX=parseInt($(".engine-position").css("left"),10),this.flickTweenX.kill()),this.flickTweenY&&(this.offsetY=parseInt($(".engine-position").css("top"),10),this.flickTweenY.kill())},mouseMove:function(a){a.preventDefault(),this.is_touch_device||(this.mouseX=a.pageX,this.mouseY=a.pageY,this.move())},move:function(){this.endDragTime=new Date,this.dx=this.mouseX-this.mousePreviousX,this.dy=this.mouseY-this.mousePreviousY,this._mouseDown&&!this._flickingX&&(this._dragging=!0,this.offsetX+=3*this.dx*(this.zoomMax+.1-this.zoom),$(".engine-position").css({left:this.offsetX})),this._mouseDown&&!this._flickingY&&(this._dragging=!0,this.offsetY+=3*this.dy*(this.zoomMax+.1-this.zoom),$(".engine-position").css({top:this.offsetY})),this.mousePreviousX=this.mouseX,this.mousePreviousY=this.mouseY},mouseUp:function(a){a.preventDefault(),this.is_touch_device||(trace("mouseUp"),this.up())},up:function(){this.endDragTime=new Date,this._mouseDown=!1,this._dragging=!1,this.flick()},flick:function(){var a=this,b=this.endDragTime-this.startDragTime;if(0!==b){var c=this.dx/b,d=this.dy/b;(!this._flickingX&&Math.abs(c)>.15||Math.abs(d)>.15)&&(this._flickingX=!0,this.offsetX+=3e3*c,this.flickTweenX=TweenMax.to($(".engine-position"),1,{css:{left:a.offsetX},onComplete:function(){a._flickingX=!1,$scope.$apply()}})),(!this._flickingY&&Math.abs(c)>.15||Math.abs(d)>.15)&&(this._flickingY=!0,this.offsetY+=3e3*d,this.flickTweenY=TweenMax.to($(".engine-position"),1,{css:{top:a.offsetY},onComplete:function(){a._flickingY=!1,$scope.$apply()}}))}}};return b.setupTouchEvents(),b}])}(),function(){"use strict";angular.module("FScapeApp.Controllers").controller("ErrorController",["$scope","$element","ErrorService","BaseController",function(a,b,c,d){var e={errorService:null,el:null,onInit:function(){this.el=b,this.errorService=c}};return angular.extend(e,new d(a)),e.init(b),e}])}(),function(){"use strict";angular.module("FScapeApp.Modals").factory("ErrorModal",["btfModal",function(a){return a({controllerAs:"DebugCtrl",templateUrl:"main/core/modals/errorModal/error.tpl.html",wrapperUrl:"main/core/overlay-containers/fullscreen/overlay.tpl.html"})}])}(),function(){"use strict";angular.module("FScapeApp.Services").factory("ErrorService",function(){return{errorMessage:null,dataSaved:function(a){this.errorMessage=a},setErrorMessage:function(){}}})}(),function(){"use strict";angular.module("FScapeApp.Controllers").controller("SuccessController",["$scope","$element","BaseController",function(a,b,c){var d={el:null,onInit:function(){this.el=b}};return angular.extend(d,new c(a)),d.init(b),d}])}(),function(){"use strict";angular.module("FScapeApp.Modals").factory("SuccessModal",["btfModal",function(a){return a({templateUrl:"main/core/modals/successModal/success.tpl.html",wrapperUrl:"main/core/overlay-containers/fullscreen/overlay.tpl.html"})}])}(),angular.module("FScapeApp.Models").factory("configModel",["BaseModel","configService","$q",function(a,b,c){var d={totalPages:820,cdnVersion:"v12",cdnPrefix:"http://d2zwcujesf1bgv.cloudfront.net/",basePath:"prod/:version/images/",pathThumbnail:"tiny_preload_size",pathWebsize:"websize_1024",license:null,tileWidth:1004,tileHeight:768,startPage:719},e=new a(d,b);return e.getConfig=function(){var a=this,b=c.defer();return null===a.data?this.service.getConfig().then(function(c){a.data=c.data,b.resolve(a.data)},function(){a.data=fallback}):b.resolve(this.data),b.promise},e}]),function(){"use strict";var a="config",b=a+"Service";angular.module("FScapeApp.Services").factory(b,["BaseHttpService","$http",function(b,c){var d=new b;return d.modelName=a,d.servicePath=a.toLowerCase(),d.getConfig=function(){var a=this.buildResourcePath()+"foreverscape.json";return c({url:a,method:"GET",data:{},params:{}})},d}])}(),function(){"use strict";angular.module("FScapeApp.Services").factory("globalModelService",function(){return{updatedData:null,successCallback:null,dataSaved:function(a){this.updatedData=a,this.successCallback&&this.successCallback(this.updatedData)},setSuccessCallback:function(a){this.successCallback=a}}})}(),angular.module("FScapeApp.Models").factory("gridModel",["configModel","tileModel",function(a,b){var c={gridBoxes:[],init:function(){var c=this;a.getConfig().then(function(){b.getTiles().then(function(){for(var d=0;150>d;d++){var e=16711680,f=a.data.startPage,g=0,h=0,i=0+f;d>=50&&100>d&&(g=-9,h=5,e=65280,i=-40+f),d>=100&&(g=-18,h=10,e=255,i=-80+f);var j=d+i;j>a.data.totalPages&&(j=Math.abs(j-a.data.totalPages)),c.gridBoxes.push({id:d,domId:"grid-"+d,transientId:d,isOnScreen:!1,row:Math.floor(d/5)+g,col:d%5+h,width:a.data.tileWidth,height:a.data.tileHeight,currentTile:b.tiles[d+i],currentTileId:j,x:0,y:0,color:e})}for(var d=0;d<c.gridBoxes.length;d++){var k=c.gridBoxes[d];k.x=k.col*k.width,k.y=k.row*k.height,k.thumbSrc=b.tiles[d].thumbUrl}})})}};return c.init(),c}]),angular.module("FScapeApp.Models").factory("tileModel",["BaseModel","tileService","configModel","generalUtils","$q",function(a,b,c,d,e){var f=[],g=new a(f,b);return g.tiles=[],g.getTiles=function(){var a=this;return console.log(printStackTrace()),c.getConfig().then(function(){return a.createTiles(),a.tiles&&(a.cachedTilesPromise=e.when(a.tiles)),a.cachedTilesPromise||(a.cachedTilesPromise=a.service.getTiles().then(function(b){a.data=a.updateTileData(b.data)})),a.cachedTilesPromise})},g.updateTileData=function(a){for(var b=0;b<c.data.totalPages;b++)this.tiles[b].name=a.names[b]},g.createTiles=function(){for(var a=[],b=c.data,e=0;e<c.data.totalPages;e++){var f={id:e,index:e,row:Math.floor(e/5),col:e%5,name:"..",absoluteX:e*b.tileWidth,absoluteY:0,thumbUrl:d.path.combine(b.cdnPrefix,b.basePath.replace(":version",b.cdnVersion),b.pathThumbnail,"forever_"+d.string.pad(e+1,"0",4)+".jpg"),fullUrl:d.path.combine(b.cdnPrefix,b.basePath.replace(":version",b.cdnVersion),b.pathWebsize,"forever_"+d.string.pad(e+1,"0",4)+".jpg")};a.push(f)}return this.tiles=a,a},g}]),function(){"use strict";var a="tile",b=a+"Service";angular.module("FScapeApp.Services").factory(b,["BaseHttpService","$http",function(b,c){var d=new b;return d.modelName=a,d.servicePath=a.toLowerCase(),d.getTiles=function(){var a=this.buildResourcePath()+"tiles2000.json";return c({url:a,method:"GET",data:{},params:{}})},d}])}(),function(){"use strict";angular.module("FScapeApp.Controllers").controller("overlayController",["$scope","$element","$controller",function(a,b){var c={scope:null,overlay:null,showHelpIcon:!1,showCloseIcon:!0,showOverlay:!1,deactivateOnShadowClick:!0,init:function(a,b){var c=this;this.scope=a,this.overlay=b,this.$scope=a,$("body").addClass("noscroll"),this.showOverlay=!0,a.$on("$destroy",function(){}),a.$on("closeOverlay",function(){c.close()}),this.defineListeners()},defineListeners:function(){},undefineListeners:function(){},onShadowClick:function(a){this.deactivateOnShadowClick&&this.overlay&&a.target===this.overlay[0]&&this.close()},close:function(){$("body").removeClass("noscroll"),angular.element(this.overlay).remove()},show:function(){this.showOverlay=!0,this.defineListeners(),this.scope.$digest()}};return c.init(a,b),c}])}(),function(){"use strict";var a=angular.module("konst",[]);a.factory("enums",function(){var a={};return Object.hasOwnProperty("freeze")&&Object.freeze(a),a})}(),function(){"use strict";angular.module("FScapeApp.Modals").factory("btfModal",["$animate","$compile","$rootScope","$controller","$q","$http","$templateCache",function(a,b,c,d,e,f,g){return function(h){function i(a,b,c){return w=b,x=c,e.all({tHtml:s,wHtml:r}).then(function(b){j(b,a)})}function j(e,f){if(t=angular.element(e.wHtml),u=angular.element(e.tHtml),0===t.length||0===u.length)throw new Error("The template contains no elements; you need to wrap text nodes");if(t.find("overlay-content").append(u),a.enter(t,q),n=c.$new(),f)for(var g in f)n[g]=f[g];var h=d(o,{$scope:n});h.success=w,h.error=x,p&&(n[p]=h),b(t)(n)}function k(){var b=e.defer();return v?a.leave(v,function(){n.$destroy(),v=null,b.resolve()}):b.resolve(),b.promise}function l(){return!!v}if(!(!h.template^!h.templateUrl))throw new Error("Expected modal to have exactly one of either `template` or `templateUrl`");var m,n,o=(h.template,h.controller||angular.noop),p=h.controllerAs,q=angular.element(h.container||document.body),r=null,s=null,t=null,u=null,v=null,w=null,x=null;if(h.template){var y=e.defer();y.resolve(h.template),m=y.promise}else s=f.get(h.templateUrl,{cache:g}).then(function(a){return a.data}),r=f.get(h.wrapperUrl,{cache:g}).then(function(a){return a.data});return{activate:i,deactivate:k,active:l}}}])}(),function(){"use strict";angular.module("FScapeApp.Services").factory("generalUtils",function(){return{path:{combine:function(){for(var a=[],b=[].slice.apply(arguments),c=0;c<b.length;c++){for(var d=b[c];"/"===d.charAt(d.length-1);)d=d.substring(0,d.length-1);a.push(d)}return a.join("/")}},string:{pad:function(a,b,c){for(a=a.toString();a.length<c;)a=b+a;return a}}}})}();
//# sourceMappingURL=core.min.map